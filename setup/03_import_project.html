<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeremy Mikecz">
<meta name="dcterms.date" content="2026-01-13">

<title>Import Python Project Tutorial with UV</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="03_import_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_import_project_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="03_import_project_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="03_import_project_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="03_import_project_files/libs/quarto-html/popper.min.js"></script>
<script src="03_import_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03_import_project_files/libs/quarto-html/anchor.min.js"></script>
<link href="03_import_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_import_project_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03_import_project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03_import_project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03_import_project_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Import Python Project Tutorial with UV</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Jeremy Mikecz </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Research Faciliation, Dartmouth Libraries
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 13, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="importing-an-existing-python-project-with-vsc-and-uv" class="level1">
<h1>Importing an existing Python Project with VSC and UV</h1>
<p>This document provides detailed instructions for setting up your Python environment for this course/workshop. You should have already read the information in the <a href="00_setup-slides.html">00_setup_slides</a> and completed the installation of Visual Studio Code and Python using uv by following <a href="01_python-setup-instructions.qmd">Setup Notebook 01</a>.</p>
<section id="table-of-contents" class="level2">
<h2 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h2>
</section>
<section id="downloading-a-project-repository-from-github" class="level2">
<h2 class="anchored" data-anchor-id="downloading-a-project-repository-from-github">Downloading a Project Repository from Github</h2>
<section id="option-1-download-as-zip" class="level3">
<h3 class="anchored" data-anchor-id="option-1-download-as-zip">Option 1: Download as ZIP</h3>
<p><em>This method is recommended for newer programmers not yet familiar with git and Github and for any user who only needs a static copy of the repository.</em></p>
<ol type="1">
<li><p>open the chosen GitHub repository. In this tutorial, we will import <a href="https://github.com/Dartmouth-Libraries/py-essentials_ws">the repository for Dartmouth Libraries’ Python Essential Workshop Series</a>.<!--Mrinank Bhowmick's ["Python Beginner Project"](https://github.com/Mrinank-Bhowmick/python-beginner-projects/tree/main#) repository. --><!--[the Github repository that supplements](https://github.com/DataScienceUB/introduction-datascience-python-book/tree/master) the book, Igual and Seguí, *Introduction to Data Science* (Springer, 2017).--></p></li>
<li><p>Click the green “Code” button on the repository page</p></li>
<li><p>Select “Download ZIP”</p></li>
<li><p>Extract the ZIP file to a memorable location (e.g., <code>~/Documents/Python-Courses/</code>)</p></li>
<li><p><strong>Important:</strong> To get updates, you’ll need to re-download</p></li>
</ol>
</section>
<section id="option-2-using-git-advanced" class="level3">
<h3 class="anchored" data-anchor-id="option-2-using-git-advanced">Option 2: Using Git (Advanced)</h3>
<p><em>This method is recommended for users familiar with git and Github, have git installed, have a Github account, and who wish to create a dynamic copy (“clone”) of the repository. A clone allows you to update your local repo when its online counterpart as been updated (using the pull command in git). It also allows you to push any changes you made locally back up to the remote repository, but only if the repository administrator has given you these privileges.</em></p>
<p>If you have Git installed:</p>
<pre class="{bash}"><code># before cloning, move the current working directory to the folder where you want to clone this project
git clone [REPOSITORY-URL]
# for example:
# git clone git@github.com:Dartmouth-Libraries/py-essentials_ws.git</code></pre>
<p>To update the local version of the repository after the online version has been updated:</p>
<pre class="{bash}"><code>git pull origin main</code></pre>
</section>
</section>
<section id="setting-up-the-python-environment" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-the-python-environment">Setting Up the Python Environment</h2>
<section id="step-1-navigate-to-the-project-directory" class="level3">
<h3 class="anchored" data-anchor-id="step-1-navigate-to-the-project-directory">Step 1: Navigate to the Project Directory</h3>
<pre class="{bash}"><code>cd path/to/[repository-name]</code></pre>
</section>
<section id="step-2-create-virtual-environment-and-install-dependencies" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-virtual-environment-and-install-dependencies">Step 2: Create Virtual Environment and Install Dependencies</h3>
<section id="a.-if-the-imported-project-is-a-uv-project" class="level4">
<h4 class="anchored" data-anchor-id="a.-if-the-imported-project-is-a-uv-project">2a. If the Imported Project is a <strong>uv</strong> project</h4>
<p>You can tell if a repository is set up for <strong>uv</strong> if it has a <code>uv.lock</code> file in its root folder.</p>
<p>Run the following in the <strong>terminal</strong>:</p>
<pre class="{bash}"><code># This creates a .venv directory and installs all packages
uv sync</code></pre>
<p>This command:</p>
<ul>
<li><p>Creates a virtual environment in <code>.venv/</code></p></li>
<li><p>Installs Python if the correct version isn’t available</p></li>
<li><p>Installs all packages specified in <code>pyproject.toml</code></p></li>
<li><p>Creates/updates <code>uv.lock</code> for reproducibility</p></li>
</ul>
</section>
<section id="b.-if-the-imported-project-has-a-requirements.txt-file" class="level4">
<h4 class="anchored" data-anchor-id="b.-if-the-imported-project-has-a-requirements.txt-file">2b. If the Imported Project has a <code>requirements.txt</code> file</h4>
<p>Prior to <strong>uv</strong>, Python project dependencies were usually stored in a <code>requirements.txt</code> file. To install all dependencies from this file and convert the project to a uv project, run the following in the <strong>terminal</strong>:</p>
<ol type="1">
<li>First, initiate <strong>uv</strong> for this project:</li>
</ol>
<pre><code>uv sync</code></pre>
<ol start="2" type="1">
<li></li>
</ol>
<pre><code>uv add -r requirements.txt</code></pre>
<p>If this doesn’t provide desired results, review the <a href="https://docs.astral.sh/uv/guides/migration/pip-to-project/">documentation on this process</a> in the uv guide.</p>
</section>
<section id="c.-if-the-imported-project-has-no-dependencies-list" class="level4">
<h4 class="anchored" data-anchor-id="c.-if-the-imported-project-has-no-dependencies-list">2c. If the Imported Project has no dependencies list</h4>
</section>
</section>
<section id="step-3-verify-installation" class="level3">
<h3 class="anchored" data-anchor-id="step-3-verify-installation">Step 3: Verify Installation</h3>
<p><strong>Note:</strong> This may take 5-10 minutes on first run.</p>
<pre class="{bash}"><code># Run the setup verification script
uv run python scripts/00_setup.py</code></pre>
</section>
</section>
<section id="configuring-visual-studio-code" class="level2">
<h2 class="anchored" data-anchor-id="configuring-visual-studio-code">Configuring Visual Studio Code</h2>
<section id="step-1-open-the-project" class="level3">
<h3 class="anchored" data-anchor-id="step-1-open-the-project">Step 1: Open the Project</h3>
<ol type="1">
<li><p>Launch VS Code</p></li>
<li><p>File → Open Folder</p></li>
<li><p>Select the course repository folder</p></li>
</ol>
</section>
<section id="step-2-select-python-interpreter" class="level3">
<h3 class="anchored" data-anchor-id="step-2-select-python-interpreter">Step 2: Select Python Interpreter</h3>
<ol type="1">
<li><p>Open Command Palette (Ctrl+Shift+P on Windows/Linux, Cmd+Shift+P on macOS)</p></li>
<li><p>Type “Python: Select Interpreter”</p></li>
<li><p>Choose the interpreter from <code>.venv</code> (it should show up as <code>./venv/bin/python</code> or similar)</p></li>
</ol>
<p><strong>If the .venv interpreter doesn’t appear:</strong></p>
<ul>
<li><p>Click “Enter interpreter path…”</p></li>
<li><p>Navigate to: <code>.venv/Scripts/python.exe</code> (Windows) or <code>.venv/bin/python</code> (Mac/Linux)</p></li>
</ul>
</section>
<section id="step-3-configure-jupyter" class="level3">
<h3 class="anchored" data-anchor-id="step-3-configure-jupyter">Step 3: Configure Jupyter</h3>
<p>When you open a <code>.ipynb</code> file:</p>
<ol type="1">
<li><p>VS Code will prompt you to select a kernel</p></li>
<li><p>Choose the same <code>.venv</code> Python interpreter</p></li>
</ol>
</section>
<section id="step-4-test-in-vs-code" class="level3">
<h3 class="anchored" data-anchor-id="step-4-test-in-vs-code">Step 4: Test in VS Code</h3>
<ol type="1">
<li><p>Open <code>scripts/00_setup.py</code></p></li>
<li><p>You should see the Python version in the bottom-right status bar</p></li>
<li><p>Right-click in the editor → “Run Python File in Terminal”</p></li>
</ol>
</section>
</section>
<section id="verifying-your-setup" class="level2">
<h2 class="anchored" data-anchor-id="verifying-your-setup">Verifying Your Setup</h2>
<section id="quick-verification" class="level3">
<h3 class="anchored" data-anchor-id="quick-verification">Quick Verification</h3>
<pre class="{bash}"><code># Activate environment and run verification script
uv run python scripts/00_setup.py</code></pre>
</section>
<section id="manual-verification" class="level3">
<h3 class="anchored" data-anchor-id="manual-verification">Manual Verification</h3>
<p>You can also test manually:</p>
<pre class="{bash}"><code># Check Python version
uv run python --version

# Test package imports
uv run python -c "import pandas; import numpy; import matplotlib; print('All packages loaded successfully!')"

# List installed packages
uv pip list</code></pre>
</section>
</section>
<section id="troubleshooting" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting">Troubleshooting</h2>
<section id="issue-uv-command-not-found" class="level3">
<h3 class="anchored" data-anchor-id="issue-uv-command-not-found">Issue: <code>uv: command not found</code></h3>
<p><strong>Solution:</strong> The installation directory isn’t in your PATH.</p>
<p><strong>Windows:</strong><br>
Add <code>%USERPROFILE%\.cargo\bin</code> to your PATH environment variable.</p>
<p><strong>macOS/Linux:</strong><br>
Add this to your <code>~/.bashrc</code>, <code>~/.zshrc</code>, or equivalent:</p>
<pre class="{bash}"><code>export PATH="$HOME/.cargo/bin:$PATH"</code></pre>
<p>Then run: <code>source ~/.bashrc</code> (or <code>~/.zshrc</code>)</p>
</section>
<section id="issue-python-version-x.y-required-but-x.z-found" class="level3">
<h3 class="anchored" data-anchor-id="issue-python-version-x.y-required-but-x.z-found">Issue: “Python version X.Y required but X.Z found”</h3>
<p><strong>Solution:</strong> uv can install Python for you:</p>
<pre class="{bash}"><code>uv python install 3.11
uv sync</code></pre>
</section>
<section id="issue-package-installation-fails-with-compilation-errors" class="level3">
<h3 class="anchored" data-anchor-id="issue-package-installation-fails-with-compilation-errors">Issue: Package installation fails with compilation errors</h3>
<p><strong>Solution 1:</strong> Ensure you have build tools installed</p>
<p><strong>Windows:</strong></p>
<ul>
<li>Install <a href="https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022">Visual Studio Build Tools</a></li>
</ul>
<p><strong>macOS</strong>:</p>
<pre class="{bash}"><code>xcode-select --install</code></pre>
<p>Linux (Ubuntu/Debian):</p>
<pre class="{bash}"><code>sudo apt-get install build-essential python3-dev</code></pre>
<p><strong>Solution 2:</strong> Try installing pre-built wheels:</p>
<pre class="{bash}"><code>uv pip install --only-binary :all: [package-name]</code></pre>
</section>
<section id="issue-vs-code-doesnt-recognize-the-.venv-interpreter" class="level3">
<h3 class="anchored" data-anchor-id="issue-vs-code-doesnt-recognize-the-.venv-interpreter">Issue: VS Code doesn’t recognize the .venv interpreter</h3>
<p><strong>Solution:</strong></p>
<ol type="1">
<li><p>Make sure <code>.venv</code> folder exists in your project root</p></li>
<li><p>Reload VS Code (Ctrl+Shift+P → “Developer: Reload Window”)</p></li>
<li><p>Manually browse to the interpreter:</p></li>
</ol>
<pre><code>-   Windows: `.venv\Scripts\python.exe`

-   Mac/Linux: `.venv/bin/python`</code></pre>
</section>
<section id="issue-jupyter-notebooks-wont-run" class="level3">
<h3 class="anchored" data-anchor-id="issue-jupyter-notebooks-wont-run">Issue: Jupyter notebooks won’t run</h3>
<p><strong>Solution:</strong></p>
<ol type="1">
<li><p>Ensure Jupyter extension is installed</p></li>
<li><p>Install ipykernel in your environment:</p></li>
</ol>
<pre class="{bash}"><code>uv pip install ipykernel</code></pre>
<ol type="1">
<li><p>Select the <code>.venv</code> kernel when opening a notebook</p></li>
<li><p>Restart VS Code if needed</p></li>
</ol>
</section>
<section id="issue-import-could-not-be-resolved-warnings-in-vs-code" class="level3">
<h3 class="anchored" data-anchor-id="issue-import-could-not-be-resolved-warnings-in-vs-code">Issue: “Import could not be resolved” warnings in VS Code</h3>
<p><strong>Solution:</strong></p>
<ol type="1">
<li><p>Ensure you’ve selected the correct Python interpreter</p></li>
<li><p>Check that <code>python.analysis.extraPaths</code> includes your project root</p></li>
<li><p>Reload VS Code window</p></li>
</ol>
</section>
<section id="issue-cannot-write-to-.venv-directory-permission-errors" class="level3">
<h3 class="anchored" data-anchor-id="issue-cannot-write-to-.venv-directory-permission-errors">Issue: Cannot write to <code>.venv</code> directory (permission errors)</h3>
<p><strong>Solution:</strong></p>
<ul>
<li><p>Don’t use <code>sudo</code> with uv commands</p></li>
<li><p>Ensure you have write permissions to the project directory</p></li>
<li><p>On Windows, run terminal as regular user (not administrator)</p></li>
</ul>
</section>
<section id="issue-uv-sync-is-very-slow" class="level3">
<h3 class="anchored" data-anchor-id="issue-uv-sync-is-very-slow">Issue: <code>uv sync</code> is very slow</h3>
<p><strong>Possible causes:</strong></p>
<ul>
<li><p>First run always takes longer</p></li>
<li><p>Slow internet connection</p></li>
<li><p>Antivirus scanning</p></li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li><p>Be patient on first run</p></li>
<li><p>Disable antivirus temporarily for <code>.venv</code> folder</p></li>
<li><p>Use <code>uv sync --offline</code> if you’ve run it before</p></li>
</ul>
</section>
</section>
<section id="best-practices-for-this-course" class="level2">
<h2 class="anchored" data-anchor-id="best-practices-for-this-course">Best Practices for This Course</h2>
<section id="file-organization" class="level3">
<h3 class="anchored" data-anchor-id="file-organization">File Organization</h3>
<ul>
<li><p>Keep all work within this project folder</p></li>
<li><p>Use relative paths (or <code>pathlib</code>)</p></li>
<li><p>Save scripts with descriptive names: <code>verb_noun.py</code> (e.g., <code>analyze_sales.py</code>)</p></li>
</ul>
</section>
<section id="naming-conventions" class="level3">
<h3 class="anchored" data-anchor-id="naming-conventions">Naming Conventions</h3>
<p><strong>Good:</strong></p>
<ul>
<li><p><code>clean_data.py</code></p></li>
<li><p><code>2024_01_15_sales_report.csv</code></p></li>
<li><p><code>figure_01_scatterplot.png</code></p></li>
</ul>
<p><strong>Bad:</strong></p>
<ul>
<li><p><code>script1.py</code></p></li>
<li><p><code>final FINAL (2) copy.py</code></p></li>
<li><p><code>sales data.csv</code> (spaces can be problematic)</p></li>
</ul>
</section>
<section id="running-python-code" class="level3">
<h3 class="anchored" data-anchor-id="running-python-code">Running Python Code</h3>
<p><strong>In Terminal:</strong></p>
<pre class="{bash}"><code># Always use uv run to ensure correct environment
uv run python scripts</code></pre>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>